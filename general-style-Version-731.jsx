var doc = app.activeDocument,    _pages = doc.pages, i, j, k, l,    _textframes, _tables, _frame, _tables1, _tables2, _rows,  _row, _row1, _row2, _cell, _cell1,_cell2, splitstr, newsplit1, rownum, str = " ", str1=" ", content = "", docStory, docTable, myText, myTable, myFrame, _tfheight, currentheight, TabCells, finalheightofcell, newRows, newCells, tempContents="", sttr="", spllitedstr=" ", newsplit=" ";var mySourceTable = doc.selection[0];var temp=0;for (i = 0; i < _pages.length; i++) {      content="";      if((_pages.length-1)-i>1)      {                             _tables=doc.stories.item(i).tables;                            _tables1=doc.stories.item(i+1).tables;                            _tables2=doc.stories.item(i+2).tables;                            _rows=_tables.item(0).rows;                            _row1=_tables1.item(0).rows;                            _row2=_tables2.item(0).rows;                            for(k=0;k<_rows.length;k++)                            {                                   _cell=_rows.item(k).cells;                                _cell1=_row1.item(k).cells;                                _cell2=_row2.item(k).cells;                                if(k==0)                                {                                                content+="[Metallic] Aetna Health Plan options in [State]||||||[Metallic] Aetna Health Plan options in [State]||||#";                                                content+="||||||(Continued)||||#";                                }                                else if(k==1)                                {                                                    if(_cell.length==2 && _cell1.length==2 && _cell2.length==2)                                                    {                                                                str = _rows.item(k-1).cells.item(0).contents;                                                                spliitedstr = str.split("M");                                                                 str=_row1.item(k-1).cells.item(0).contents;                                                                newsplit=str.split("M");                                                                str=_row2.item(k-1).cells.item(0).contents;                                                                newsplit1=str.split("M");                                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"|||"+newsplit1[0]+"|#";                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                                content+="|"+_cell1.item(1).contents+"|||"+_cell2.item(1).contents+"|#";                                                         }                                                     else if(_cell.length==2 && _cell1.length==2 && _cell2.length==3)                                                    {                                                                str = _rows.item(k-1).cells.item(0).contents;                                                                spliitedstr = str.split("M");                                                                 str=_row1.item(k-1).cells.item(0).contents;                                                                newsplit=str.split("M");                                                                str=_row2.item(k-1).cells.item(0).contents;                                                                newsplit1=str.split("M");                                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"|||"+newsplit1[0]+"|#";                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                                content+="|"+_cell1.item(1).contents+"|||"+_cell2.item(1).contents+"|"+_cell2.item(2).contents+"#";                                                         }                                                       else if(_cell.length==2 && _cell1.length==3 && _cell2.length==2)                                                    {                                                                str = _rows.item(k-1).cells.item(0).contents;                                                                spliitedstr = str.split("M");                                                                 str=_row1.item(k-1).cells.item(0).contents;                                                                newsplit=str.split("M");                                                                str=_row2.item(k-1).cells.item(0).contents;                                                                newsplit1=str.split("M");                                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"|||"+newsplit1[0]+"|#";                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"||"+_cell2.item(1).contents+"|#";                                                         }                                                             else if(_cell.length==2 && _cell1.length==3 && _cell2.length==3)                                                    {                                                                str = _rows.item(k-1).cells.item(0).contents;                                                                spliitedstr = str.split("M");                                                                 str=_row1.item(k-1).cells.item(0).contents;                                                                newsplit=str.split("M");                                                                str=_row2.item(k-1).cells.item(0).contents;                                                                newsplit1=str.split("M");                                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"|||"+newsplit1[0]+"|#";                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"||"+_cell2.item(1).contents+"|"+_cell2.item(2).contents+"#";                                                         }                                                        else if(_cell.length==3 && _cell1.length==2 && _cell2.length==2)                                                    {                                                                str = _rows.item(k-1).cells.item(0).contents;                                                                spliitedstr = str.split("M");                                                                 str=_row1.item(k-1).cells.item(0).contents;                                                                newsplit=str.split("M");                                                                str=_row2.item(k-1).cells.item(0).contents;                                                                newsplit1=str.split("M");                                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"|||"+newsplit1[0]+"|#";                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                                content+="|"+_cell1.item(1).contents+"|||"+_cell2.item(1).contents+"|#";                                                         }                                                           else if(_cell.length==3 && _cell1.length==2 && _cell2.length==3)                                                    {                                                                str = _rows.item(k-1).cells.item(0).contents;                                                                spliitedstr = str.split("M");                                                                 str=_row1.item(k-1).cells.item(0).contents;                                                                newsplit=str.split("M");                                                                str=_row2.item(k-1).cells.item(0).contents;                                                                newsplit1=str.split("M");                                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"|||"+newsplit1[0]+"|#";                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                                content+="|"+_cell1.item(1).contents+"|||"+_cell2.item(1).contents+"|"+_cell2.item(2).contents+"#";                                                         }                                                        else if(_cell.length==3 && _cell1.length==3 && _cell2.length==2)                                                    {                                                                str = _rows.item(k-1).cells.item(0).contents;                                                                spliitedstr = str.split("M");                                                                 str=_row1.item(k-1).cells.item(0).contents;                                                                newsplit=str.split("M");                                                                str=_row2.item(k-1).cells.item(0).contents;                                                                newsplit1=str.split("M");                                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"|||"+newsplit1[0]+"#";                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"||"+_cell2.item(1).contents+"|#";                                                         }                                                        else if(_cell.length==3 && _cell1.length==3 && _cell2.length==3)                                                    {                                                                str = _rows.item(k-1).cells.item(0).contents;                                                                spliitedstr = str.split("M");                                                                 str=_row1.item(k-1).cells.item(0).contents;                                                                newsplit=str.split("M");                                                                str=_row2.item(k-1).cells.item(0).contents;                                                                newsplit1=str.split("M");                                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"|||"+newsplit1[0]+"|#";                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"||"+_cell2.item(1).contents+"|"+_cell2.item(2).contents+"#";                                                         }                                                                                      }                                else                                {                                                if(_cell.length==1&& _cell1.length==1 && _cell2.length==1)                                                {                                                                content+=_cell.item(0).contents+"||||||||||#";                                                }                                                    else if(_cell.length==2 && _cell1.length==2 && _cell2.length==2)                                                    {                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                                content+="|"+_cell1.item(1).contents+"|||"+_cell2.item(1).contents+"|#";                                                         }                                                     else if(_cell.length==2 && _cell1.length==2 && _cell2.length==3)                                                    {                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                                content+="|"+_cell1.item(1).contents+"|||"+_cell2.item(1).contents+"|"+_cell2.item(2).contents+"#";                                                         }                                                       else if(_cell.length==2 && _cell1.length==3 && _cell2.length==2)                                                    {                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"||"+_cell2.item(1).contents+"|#";                                                         }                                                             else if(_cell.length==2 && _cell1.length==3 && _cell2.length==3)                                                    {                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"||"+_cell2.item(1).contents+"|"+_cell2.item(2).contents+"#";                                                         }                                                        else if(_cell.length==3 && _cell1.length==2 && _cell2.length==2)                                                    {                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                                content+="|"+_cell1.item(1).contents+"|||"+_cell2.item(1).contents+"|#";                                                         }                                                           else if(_cell.length==3 && _cell1.length==2 && _cell2.length==3)                                                    {                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                                content+="|"+_cell1.item(1).contents+"|||"+_cell2.item(1).contents+"|"+_cell2.item(2).contents+"#";                                                         }                                                        else if(_cell.length==3 && _cell1.length==3 && _cell2.length==2)                                                    {                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"||"+_cell2.item(1).contents+"|#";                                                         }                                                        else if(_cell.length==3 && _cell1.length==3 && _cell2.length==3)                                                    {                                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"||"+_cell2.item(1).contents+"|"+_cell2.item(2).contents+"#";                                                       }                                                                                                   }                            }                            i=i+2;                            _tables.item(0).remove();                            _tables1.item(0).remove();                            _tables2.item(0).remove();                            myFrame=_pages.item(i-2).textFrames.add();                            myFrame.geometricBounds=["3p0","3p0","63p0","99p0"];                            myFrame.contents=content;                            myFrame.fit(FitOptions.CONTENT_TO_FRAME);                            myText=myFrame.parentStory.characters.itemByRange(-1, -content.length);                            myTable=myText.convertToTable("|", "#", 11);      }      else if((_pages.length-1)-i==1)      {                             _tables=doc.stories.item(i).tables;                            _tables1=doc.stories.item(i+1).tables;                            _rows=_tables.item(0).rows;                            _row1=_tables1.item(0).rows;                                                        for(k=0;k<_rows.length;k++)                            {                                _cell=_rows.item(k).cells;                                _cell1=_row1.item(k).cells;                                 if(k==0)                                {                                                content+="[Metallic] Aetna Health Plan options in [State]||||||[Metallic] Aetna Health Plan options in [State]||||#";                                                content+="||||||(Continued)||||#";                                }                                else if(k==1)                                {                                    if(_cell.length==2 && _cell1.length==2)                                    {                                                str = _rows.item(k-1).cells.item(0).contents;                                                spliitedstr = str.split("M");                                                 str=_row1.item(k-1).cells.item(0).contents;                                                newsplit=str.split("M");                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"||||#";                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                content+="|"+_cell1.item(1).contents+"||||#";                                    }                                    else if(_cell.length==2 && _cell1.length==3)                                    {                                                str = _rows.item(k-1).cells.item(0).contents;                                                spliitedstr = str.split("M");                                                 str=_row1.item(k-1).cells.item(0).contents;                                                newsplit=str.split("M");                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"||||#";                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"|||#";                                    }                                          else if(_cell.length==3 && _cell1.length==2)                                    {                                                str = _rows.item(k-1).cells.item(0).contents;                                                spliitedstr = str.split("M");                                                 str=_row1.item(k-1).cells.item(0).contents;                                                newsplit=str.split("M");                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"||||#";                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                content+="|"+_cell1.item(1).contents+"||||#";                                    }                                     else if(_cell.length==3 && _cell1.length==3)                                    {                                                str = _rows.item(k-1).cells.item(0).contents;                                                spliitedstr = str.split("M");                                                 str=_row1.item(k-1).cells.item(0).contents;                                                newsplit=str.split("M");                                                content+="Plan|||"+spliitedstr[0]+"|||"+newsplit[0]+"||||#";                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"|||#";                                    }                                 }                                else                                {                                                if(_cell.length==1&& _cell1.length==1)                                                {                                                                content+=_cell.item(0).contents+"||||||||||#";                                                }                                    else if(_cell.length==2 && _cell1.length==2)                                    {                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                content+="|"+_cell1.item(1).contents+"||||#";                                    }                                    else if(_cell.length==2 && _cell1.length==3)                                    {                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"||";                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"|||#";                                    }                                          else if(_cell.length==3 && _cell1.length==2)                                    {                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                content+="|"+_cell1.item(1).contents+"||||#";                                    }                                     else if(_cell.length==3 && _cell1.length==3)                                    {                                                content+=_cell.item(0).contents+"|||"+_cell.item(1).contents+"|"+_cell.item(2).contents+"|";                                                content+="|"+_cell1.item(1).contents+"|"+_cell1.item(2).contents+"|||#";                                    }                                 }                            }                            i=i+1;                            _tables.item(0).remove();                            _tables1.item(0).remove();                            myFrame=_pages.item(i-1).textFrames.add();                            myFrame.geometricBounds=["3p0","3p0","63p0","99p0"];                            myFrame.contents=content;                            myFrame.fit(FitOptions.CONTENT_TO_FRAME);                            myText=myFrame.parentStory.characters.itemByRange(-1, -content.length);                            myTable=myText.convertToTable("|", "#", 11);              }      else if((_pages.length-1)-i==0)      {                                  _tables = doc.stories.item(i).tables;                        for (j = 0; j < _tables.length; j++)                        {                                _row = _tables.item(j).rows;                                for (k = 0; k < _row.length; k++)                                {                                     _cell = _row.item(k).cells;                                     for (l = 0; l < _cell.length; l++)                                     {                                             if (k == 0)                                             {                                                       str = _cell.item(l).contents;                                                       spliitedstr = str.split("M");                                                                         newsplit = str.split(" ");                                                       content += " [Metallic] Aetna Health Plan options in [State]##Plan|                                                ||"+newsplit[1]+" "+spliitedstr[0];                                              }                                              else if (k==1)                                              {                                                        if(_cell.length==2)                                                        {                                                                if(l==0)                                                                {                                                                        str=_cell.item(l).contents;                                                                        content+=str+"|||";                                                                }                                                                else if(l==1)                                                                {                                                                         str=_cell.item(l).contents;                                                                         content+=str+"||";                                                                }                                                                                                                                       }                                                        else                                                        {                                                                if(l==0)                                                                {                                                                        str=_cell.item(l).contents;                                                                        content+=str+"|"+"||";                                                                }                                                                else if((l==1||l==2))                                                                {                                                                        if(l==1)                                                                        {                                                                                     str=_cell.item(l).contents;                                                                                    content+=str+"|";                                                                        }                                                                        else if(l==2)                                                                        {                                                                                        str=_cell.item(l).contents;                                                                                     content+=str;                                                                        }                                                                }                                                                                                                    }                                               }                                                  else                                               {                                                         if(l==0)                                                         {                                                                    str=_cell.item(l).contents;                                                                    content+="|"+str+"|";                                                          }                                                          else                                                          {                                                                     str=_cell.item(l).contents;                                                                     content+="|"+str;                                                           }                                                 }                                    }                                    content+="#";                                                                        }                         }                        _tables.item(0).remove();                        myFrame=_pages.item(i).textFrames.add();                        myFrame.geometricBounds=["3p0","3p0","63p0","48p0"];                        myFrame.contents=content;                        myFrame.fit(FitOptions.CONTENT_TO_FRAME);                        myText=myFrame.parentStory.characters.itemByRange(-1, -content.length);                        myTable=myText.convertToTable("|", "#", 5);      } }